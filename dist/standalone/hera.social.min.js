/*!
 * hera.social.js v2.0.0
 * https://github.com/crewstyle/OlympusHera
 *
 * This plugin adds a complete integration width a social buttons modal box.
 *
 * Example of JS:
 *      $('.social-block').heraSocial({
 *          active: 'active',                           //CSS class to selected social networks
 *          addbutton: 'a.add-social',                  //add social network button
 *          color: '#ffaaaa',                           //background color used when deleting a social network
 *          content: 'fieldset',                        //node element of main container
 *          delallbutton: 'a.del-all-socials',          //delete all social networks button
 *          delbutton: 'a.del-social',                  //delete social network button
 *          label: 'modal-id',                          //name used to be sent through the form
 *          items: 'fieldset > div',                    //social networks already selected
 *          modal: '#modal-socials',                    //modal block ID
 *          source: '#template-id'                      //node script element in DOM containing handlebars JS temlpate
 *      });
 *
 * Example of HTML:
 *      --
 *
 * Copyright 2016 Achraf Chouk
 * Achraf Chouk (https://github.com/crewstyle)
 */
!function(a){"use strict";var b=function(a,b){var c=this;c.$el=a,c.options=b,c.init()};b.prototype.$el=null,b.prototype.$modal=null,b.prototype.options=null,b.prototype.source=null,b.prototype.init=function(){var b=this;b.source=a(b.options.source).html(),b.$modal=a(b.options.modal),b.$modal.addClass(b.options.modalclass),a.each(b.$el.find(b.options.items),function(){b.$modal.find('a[data-nk="'+a(this).attr("data-nk")+'"]').addClass(b.options.active)}),b.$el.find(b.options.addbutton).on("click",a.proxy(b.open_modal,b)),b.$el.find(b.options.delbutton).on("click",a.proxy(b.remove_social,b)),b.$el.find(b.options.delallbutton).on("click",a.proxy(b.remove_all,b)),b.$modal.find("a[data-nk]").on("click",a.proxy(b.toggle_social,b))},b.prototype.open_modal=function(b){b.preventDefault();var c=this;a.each(c.$el.find(c.options.items),function(){c.$modal.find('a[data-nk="'+a(this).attr("data-nk")+'"]').addClass(c.options.active)}),c.$modal.heraModal({backdrop:".olz-modal-backdrop"})},b.prototype.remove_all=function(a){a.preventDefault();var b=this;b.$el.find(b.options.delbutton).click()},b.prototype.remove_social=function(b){b.preventDefault();var c=this,d=a(b.target),e="I"==d[0].nodeName?d.closest("a"):d,f=e.attr("data-nk");c._toggle("remove",f)},b.prototype.toggle_social=function(b){b.preventDefault();var c=this,d=a(b.target),e="I"==d[0].nodeName?d.closest("a"):d,f=e.attr("data-nk");e.hasClass(c.options.active)?c._toggle("remove",f):c._toggle("create",f)},b.prototype._create=function(b,c){var d=this;if(d.$el.find(d.options.items+'[data-nk="'+b+'"]').length)return void c.removeClass(d.options.active);var e=d.$el.find(d.options.content),f={nwk:b,lfor:d.options.label+"_"+b,title:c.text(),style:c.attr("style"),id:d.options.label,label:{value:"",placeholder:c.attr("data-ll")},link:{value:"",placeholder:c.attr("data-lk")}},g=Handlebars.compile(d.source),h=g(f);e.append(h);var i=d.$el.find(d.options.items+'[data-nk="'+b+'"]');i.find(d.options.delbutton).on("click",a.proxy(d.remove_social,d))},b.prototype._destroy=function(b){var c=this,d=c.$el.find(c.options.content+' > div[data-nk="'+b+'"]');d.find(c.options.delbutton).off("click",a.proxy(c.remove_social,c)),d.css("backgroundColor",c.options.color),d.stop().animate({opacity:"0"},"slow",function(){d.remove()})},b.prototype._toggle=function(a,b){var c=this,d=c.$modal.find('a[data-nk="'+b+'"]');"create"===a?(d.addClass(c.options.active),c._create(b,d)):"remove"===a&&(d.removeClass(c.options.active),c._destroy(b))};var c={init:function(c){if(!this.length)return!1;var d={active:"active",addbutton:"a.add-social",color:"#ffaaaa",content:"fieldset",delallbutton:"a.del-all-socials",delbutton:"a.del-social",label:"modal-id",items:"fieldset > div",modal:"#modal-socials",source:"#template-id"};return this.each(function(){c&&a.extend(d,c),new b(a(this),d)})},update:function(){},destroy:function(){}};a.fn.heraSocial=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on heraSocial"),!1):c.init.apply(this,arguments)}}(window.jQuery);