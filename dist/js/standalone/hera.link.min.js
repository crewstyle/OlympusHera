/*!
 * hera.link.js v2.0.0
 * https://github.com/crewstyle/OlympusHera
 *
 * This plugin change dynamically the href attribute for the link URL.
 *
 * Example of JS:
 *      $('input[type="url"]').heraLink({
 *          addbutton: '.add-link',                     //add link button
 *          color: '#ffaaaa',                           //background color used when deleting a social network
 *          container: 'fieldset',                      //node element containing all items
 *          delallbutton: 'a.del-all-links',            //delete all links button
 *          delbutton: 'a.del-link',                    //delete link button
 *          items: '.link-container',                   //node element which is used to count all elements
 *          linkbutton: 'input',                        //link button to make url clickable
 *          source: '#template-id'                      //node script element in DOM containing handlebars JS temlpate
 *      });
 *
 * Example of HTML:
 *      <div class="links">
 *          <fieldset>
 *              <div class="link-container">
 *                  <input type="url" />
 *              </div>
 *          </fieldset>
 *      </div>
 *
 * Copyright 2016 Achraf Chouk
 * Achraf Chouk (https://github.com/crewstyle)
 */
!function(a){"use strict";var b=function(b,c){var d=this;d.$el=b,d.id=b.attr("data-id"),d.options=c,d.$container=d.$el.find(d.options.container),d.num=d.$container.find(d.options.items).length+1,d.source=a(d.options.source).html(),d.$el.find(d.options.linkbutton).on("keyup",a.proxy(d.linketize,d)),d.$el.find(d.options.addbutton).on("click",a.proxy(d.add_block,d)),d.$el.find(d.options.delbutton).on("click",a.proxy(d.remove_block,d)),d.$el.find(d.options.delallbutton).on("click",a.proxy(d.remove_all,d))};b.prototype.$el=null,b.prototype.$container=null,b.prototype.id=null,b.prototype.options=null,b.prototype.num=0,b.prototype.source=null,b.prototype.linketize=function(b){b.preventDefault();var c=a(b.target||b.currentTarget);c.next("a").attr("href",c.val())},b.prototype.add_block=function(b){b.preventDefault();var c=this;a(b.target||b.currentTarget);c.num++;var d={id:c.id,lfor:c.id+"_"+c.num,num:c.num},e=Handlebars.compile(c.source),f=e(d);c.$container.append(f);var g=c.$container.find(c.options.items).last();g.find(c.options.linkbutton).on("keyup",a.proxy(c.linketize,c)),g.find(c.options.delbutton).on("click",a.proxy(c.remove_block,c)),g.find(".olz-tooltip").heraTooltip({position:"right"})},b.prototype.remove_all=function(a){a.preventDefault();var b=this;b.$el.find(b.options.delbutton).click()},b.prototype.remove_block=function(b){b.preventDefault();var c=this,d=a(b.target||b.currentTarget),e=d.closest(c.options.items);e.css("background",c.options.color),e.animate({opacity:"0"},"slow",function(){e.remove()})};var c={init:function(c){if(!this.length)return!1;var d={addbutton:".add-link",color:"#ffaaaa",container:"fieldset",delallbutton:"a.del-all-links",delbutton:"a.del-link",items:".link-container",linkbutton:".block-link input",source:"#template-id"};return this.each(function(){c&&a.extend(d,c),new b(a(this),d)})},update:function(){},destroy:function(){}};a.fn.heraLink=function(b){return c[b]?c[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error("Method "+b+" does not exist on heraLink"),!1):c.init.apply(this,arguments)}}(window.jQuery);